[gd_scene load_steps=41 format=3 uid="uid://dct6crx3jwiat"]

[ext_resource type="Script" uid="uid://nchnj2u7kv5" path="res://src/Scripts/Player.gd" id="1_rpqav"]
[ext_resource type="PackedScene" uid="uid://cwvq1yyfex6w7" path="res://src/Objects/Player/Alpi.glb" id="2_4mdpm"]
[ext_resource type="Script" uid="uid://dsi0c4pqhkju7" path="res://src/Scripts/PlayerCombat.gd" id="3_g1uh0"]
[ext_resource type="PackedScene" uid="uid://be1gwv0coi2ua" path="res://src/Scenes/WeaponInstance.tscn" id="4_5dq0m"]
[ext_resource type="PackedScene" uid="uid://yabfag3vnn0q" path="res://src/Objects/Player/RightHand.glb" id="4_8fvgu"]
[ext_resource type="PackedScene" uid="uid://sy3pu51jwruj" path="res://src/Objects/Player/LeftHand.glb" id="5_0umxx"]
[ext_resource type="Script" uid="uid://biya2r8iv253u" path="res://src/Scripts/hud.gd" id="5_ma0cp"]
[ext_resource type="Script" uid="uid://tmk08xd244ca" path="res://src/Scripts/death_screen.gd" id="6_4mdpm"]
[ext_resource type="PackedScene" uid="uid://c6box3bvo8g64" path="res://src/Scenes/PauseMenu.tscn" id="6_4mdpm"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_qbkls"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_5dq0m"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_bblsp"]
animation = &"Gun_Shoot_L"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3y32l"]
animation = &"Gun_Shoot_R"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qde8h"]
animation = &"Hammer_Swing_L"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wkd3r"]
animation = &"Hammer_Swing_R"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0umxx"]
animation = &"Walk"
use_custom_timeline = true
timeline_length = 0.0
stretch_time_scale = true
start_offset = 0.0
loop_mode = 0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_xop61"]
animation = &"Sword_Swing_L"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ws13c"]
animation = &"Sword_Swing_R"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3mr6j"]
animation = &"Walk"
use_custom_timeline = true
timeline_length = 1.0
stretch_time_scale = true
start_offset = 0.0
loop_mode = 1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bblsp"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3y32l"]
advance_mode = 2
advance_condition = &"is_moving"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qde8h"]
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bpr1r"]
advance_mode = 2
advance_condition = &"gun_shoot_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r6toq"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_elb8c"]
advance_mode = 2
advance_condition = &"hammer_swing_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_8hoe3"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fxj3g"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hhc11"]
advance_mode = 2
advance_condition = &"sword_swing_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fhgg7"]
advance_mode = 2
advance_condition = &"gun_shoot_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_85hkr"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_t5ocg"]
advance_mode = 2
advance_condition = &"hammer_swing_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qthqd"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pjlvt"]
advance_mode = 2
advance_condition = &"sword_swing_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dxf3x"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0umxx"]
advance_mode = 2
advance_condition = &"sword_swing_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3mr6j"]
advance_mode = 2
advance_condition = &"hammer_swing_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_wkd3r"]
advance_mode = 2
advance_condition = &"gun_shoot_left"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xop61"]
advance_mode = 2
advance_condition = &"sword_swing_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ws13c"]
advance_mode = 2
advance_condition = &"hammer_swing_right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5orpi"]
advance_mode = 2
advance_condition = &"gun_shoot_right"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_0umxx"]
states/End/position = Vector2(1217, 100)
states/Gun_Shoot_L/node = SubResource("AnimationNodeAnimation_bblsp")
states/Gun_Shoot_L/position = Vector2(391, -59.75)
states/Gun_Shoot_R/node = SubResource("AnimationNodeAnimation_3y32l")
states/Gun_Shoot_R/position = Vector2(391, 242.25)
states/Hammer_Swing_L/node = SubResource("AnimationNodeAnimation_qde8h")
states/Hammer_Swing_L/position = Vector2(593, -59.75)
states/Hammer_Swing_R/node = SubResource("AnimationNodeAnimation_wkd3r")
states/Hammer_Swing_R/position = Vector2(593, 242.25)
states/Idle/node = SubResource("AnimationNodeAnimation_0umxx")
states/Idle/position = Vector2(230, 100)
states/Start/position = Vector2(50, 108)
states/Sword_Swing_L/node = SubResource("AnimationNodeAnimation_xop61")
states/Sword_Swing_L/position = Vector2(892, -59.75)
states/Sword_Swing_R/node = SubResource("AnimationNodeAnimation_ws13c")
states/Sword_Swing_R/position = Vector2(887, 242.25)
states/Walk/node = SubResource("AnimationNodeAnimation_3mr6j")
states/Walk/position = Vector2(950, 100)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_bblsp"), "Idle", "Walk", SubResource("AnimationNodeStateMachineTransition_3y32l"), "Walk", "Idle", SubResource("AnimationNodeStateMachineTransition_qde8h"), "Idle", "Gun_Shoot_L", SubResource("AnimationNodeStateMachineTransition_bpr1r"), "Gun_Shoot_L", "Idle", SubResource("AnimationNodeStateMachineTransition_r6toq"), "Idle", "Hammer_Swing_L", SubResource("AnimationNodeStateMachineTransition_elb8c"), "Hammer_Swing_L", "Idle", SubResource("AnimationNodeStateMachineTransition_8hoe3"), "Sword_Swing_L", "Idle", SubResource("AnimationNodeStateMachineTransition_fxj3g"), "Idle", "Sword_Swing_L", SubResource("AnimationNodeStateMachineTransition_hhc11"), "Idle", "Gun_Shoot_R", SubResource("AnimationNodeStateMachineTransition_fhgg7"), "Gun_Shoot_R", "Idle", SubResource("AnimationNodeStateMachineTransition_85hkr"), "Idle", "Hammer_Swing_R", SubResource("AnimationNodeStateMachineTransition_t5ocg"), "Hammer_Swing_R", "Idle", SubResource("AnimationNodeStateMachineTransition_qthqd"), "Idle", "Sword_Swing_R", SubResource("AnimationNodeStateMachineTransition_pjlvt"), "Sword_Swing_R", "Idle", SubResource("AnimationNodeStateMachineTransition_dxf3x"), "Walk", "Sword_Swing_L", SubResource("AnimationNodeStateMachineTransition_0umxx"), "Walk", "Hammer_Swing_L", SubResource("AnimationNodeStateMachineTransition_3mr6j"), "Walk", "Gun_Shoot_L", SubResource("AnimationNodeStateMachineTransition_wkd3r"), "Walk", "Sword_Swing_R", SubResource("AnimationNodeStateMachineTransition_xop61"), "Walk", "Hammer_Swing_R", SubResource("AnimationNodeStateMachineTransition_ws13c"), "Walk", "Gun_Shoot_R", SubResource("AnimationNodeStateMachineTransition_5orpi")]
graph_offset = Vector2(0, -145.93324)

[node name="Player" type="CharacterBody3D"]
collision_layer = 3
script = ExtResource("1_rpqav")
speed_component = ExtResource("2_8fvgu")
health_component = ExtResource("2_4mdpm")

[node name="Collision" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_qbkls")

[node name="ThirdPersonCamera" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.8591207, 0.511773, 0, -0.511773, 0.8591207, 0, 2.7003121, 2.2092881)

[node name="FirstPersonCamera" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.4769659, 0.08534697)

[node name="HurtBox" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="HurtBox"]
shape = SubResource("CapsuleShape3D_5dq0m")
debug_color = Color(0.972549, 0, 0, 0.41960785)

[node name="Body" type="Node3D" parent="."]
script = ExtResource("3_g1uh0")

[node name="FirstPersonModel" type="MeshInstance3D" parent="Body"]
transform = Transform3D(0.99999994, 0, 0, 0, 0.99999994, 0, 0, 0, 0.99999994, -4.440892e-16, 0.2215457, -0.8567713)
skeleton = NodePath("../..")

[node name="Hands" type="Node3D" parent="Body/FirstPersonModel"]
transform = Transform3D(0.30000004, 0, 0, 0, 0.30000004, 0, 0, 0, 0.30000004, -1.9626807e-08, 0.09864569, 0.94295424)

[node name="RightHand" parent="Body/FirstPersonModel/Hands" instance=ExtResource("4_8fvgu")]
transform = Transform3D(-0.19999982, 0, -1.7484547e-08, 0, 0.19999981, 0, 1.7484547e-08, 0, -0.19999982, 0.1654366, -0.1867916, 0.03441137)

[node name="RightWeapon" parent="Body/FirstPersonModel/Hands/RightHand" instance=ExtResource("4_5dq0m")]
transform = Transform3D(-5.0000014, 0, 4.3711415e-07, 0, 5.000003, 0, -4.3711415e-07, 0, -5.0000014, -0.01623869, 0.933959, 3.0761414)

[node name="LeftHand" parent="Body/FirstPersonModel/Hands" instance=ExtResource("5_0umxx")]
transform = Transform3D(-0.19999981, 0, -1.7484549e-08, 0, 0.1999998, 0, 1.7484549e-08, 0, -0.19999981, -0.22542939, -0.1867916, 0.03441134)

[node name="LeftWeapon" parent="Body/FirstPersonModel/Hands/LeftHand" instance=ExtResource("4_5dq0m")]
transform = Transform3D(-5.0000024, 0, 4.3711438e-07, 0, 5.000005, 0, -4.3711438e-07, 0, -5.0000024, 0.009615421, 0.933959, 3.0761414)

[node name="ThirdPersonModel" parent="Body" instance=ExtResource("2_4mdpm")]
transform = Transform3D(0.3, 0, 0, 0, 0.3, 0, 0, 0, 0.3, 0, -0.27100432, 0.03606558)

[node name="Skeleton3D" parent="Body/ThirdPersonModel/Player" index="0"]
bones/1/rotation = Quaternion(0, 0.052335948, 0, 0.9986295)
bones/3/position = Vector3(0.91351366, 0.9178297, -0.046597518)
bones/3/rotation = Quaternion(-3.6259157e-06, 3.4442837e-05, -0.9961928, 0.08717797)
bones/4/rotation = Quaternion(0.0034681312, 0.001553929, -0.026134633, 0.9996512)
bones/5/position = Vector3(0.0017228425, 1.18114, -0.0058921254)
bones/5/rotation = Quaternion(0.49041736, 0.49279523, 0.45108446, 0.5596129)
bones/6/position = Vector3(-0.9135136, 0.9178297, -0.046597514)
bones/6/rotation = Quaternion(-3.6259157e-06, -3.4442837e-05, 0.9961928, 0.08717797)
bones/7/rotation = Quaternion(0.0034681312, -0.001553929, 0.026134633, 0.9996512)
bones/8/position = Vector3(-0.015371367, 1.20016, -0.0060171876)
bones/8/rotation = Quaternion(0.4904176, -0.49279496, -0.45108387, 0.5596132)
bones/9/position = Vector3(0.27663198, -0.116931096, -2.7375584e-08)
bones/9/rotation = Quaternion(0.028429903, -0.020286907, 0.9978889, -0.054752655)
bones/10/rotation = Quaternion(0.021532265, 0.030050183, 0.010409185, 0.9992623)
bones/11/position = Vector3(-0.27663198, -0.116931096, -2.7375584e-08)
bones/11/rotation = Quaternion(-0.021276433, -0.020687416, 0.99804974, 0.054918822)
bones/12/rotation = Quaternion(0.021605575, -0.022958614, -0.010255776, 0.9994504)

[node name="RightHand" type="BoneAttachment3D" parent="Body/ThirdPersonModel/Player/Skeleton3D" index="0"]
transform = Transform3D(0.025103234, 0.073140144, 0.9970055, 0.9946016, -0.10227267, -0.017539969, 0.100683525, 0.9920641, -0.07531268, -1.1936519, -0.13059747, 0.08062841)
bone_name = "Bone.004.R.001"
bone_idx = 8

[node name="RightWeapon" parent="Body/ThirdPersonModel/Player/Skeleton3D/RightHand" instance=ExtResource("4_5dq0m")]
transform = Transform3D(1.3113414e-07, -2.6226834e-07, 3, 2.6226832e-07, 3, 2.6226832e-07, -3, 2.6226832e-07, 1.3113416e-07, 0, 0, 0)

[node name="LeftHand" type="BoneAttachment3D" parent="Body/ThirdPersonModel/Player/Skeleton3D" index="1"]
transform = Transform3D(0.0036229994, 0.1347201, -0.99087703, -0.9946017, -0.10227215, -0.017541474, -0.10370233, 0.9855918, 0.1336222, 1.1954999, -0.1100539, -0.17044042)
bone_name = "Bone.004.L.001"
bone_idx = 5

[node name="LeftWeapon" parent="Body/ThirdPersonModel/Player/Skeleton3D/LeftHand" instance=ExtResource("4_5dq0m")]
transform = Transform3D(1.3113417e-07, -2.6226837e-07, 3.0000005, 2.622684e-07, 3.0000002, 2.6226837e-07, -3.0000007, 2.6226832e-07, 1.3113419e-07, 0, 0, 0)

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../Body/ThirdPersonModel")
tree_root = SubResource("AnimationNodeStateMachine_0umxx")
anim_player = NodePath("../Body/ThirdPersonModel/AnimationPlayer")
parameters/conditions/gun_shoot_left = false
parameters/conditions/gun_shoot_right = false
parameters/conditions/hammer_swing_left = false
parameters/conditions/hammer_swing_right = false
parameters/conditions/idle = false
parameters/conditions/is_moving = false
parameters/conditions/sword_swing_left = false
parameters/conditions/sword_swing_right = false
[node name="PauseMenu" parent="." instance=ExtResource("6_4mdpm")]
unique_name_in_owner = true
offset_left = 393.0
offset_top = 65.0
offset_right = 433.0
offset_bottom = 105.0

[node name="HUD" type="CanvasLayer" parent="."]

[node name="Control" type="Control" parent="HUD"]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="ProgressBar" type="ProgressBar" parent="HUD/Control"]
layout_mode = 0
offset_right = 279.0
offset_bottom = 27.0

[node name="DEATH_SCREEN" type="CanvasLayer" parent="."]
unique_name_in_owner = true

[node name="Control" type="Control" parent="DEATH_SCREEN"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="DEATH_LABEL" type="Label" parent="DEATH_SCREEN/Control"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -40.0
offset_top = -29.5
offset_right = 40.0
offset_bottom = -6.5
grow_horizontal = 2
grow_vertical = 2
text = "YOU DIED!"

[node name="RESTART" type="Button" parent="DEATH_SCREEN/Control"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -37.5
offset_top = -2.5
offset_right = 37.5
offset_bottom = 28.5
grow_horizontal = 2
grow_vertical = 2
text = "RESTART"

[connection signal="request_animation" from="Body/FirstPersonModel/Hands/RightHand/RightWeapon" to="Body/FirstPersonModel/Hands" method="_on_weapon_instance_request_animation"]
[connection signal="request_animation" from="Body/FirstPersonModel/Hands/LeftHand/LeftWeapon" to="Body/FirstPersonModel/Hands" method="_on_weapon_instance_request_animation"]
[connection signal="request_animation" from="Body/ThirdPersonModel/Player/Skeleton3D/RightHand/RightWeapon" to="Body" method="_on_right_weapon_request_animation"]
[connection signal="request_animation" from="Body/ThirdPersonModel/Player/Skeleton3D/LeftHand/LeftWeapon" to="Body" method="_on_left_weapon_request_animation"]
[connection signal="pressed" from="DEATH_SCREEN/Control/RESTART" to="DEATH_SCREEN" method="_on_restart_pressed"]

[editable path="Body/ThirdPersonModel"]
